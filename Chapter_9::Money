
#include <iostream>
#include <cctype>
#include <iomanip>

//=====================================================================================================================================
class Money
{
public:

	Money(long cent, char valuta)
		: cent(cent), valuta(valuta)
	{
	}
	//=====================================================================================================================================
	Money()
	{
	}
	//=====================================================================================================================================
	friend std::ostream &operator<<(std::ostream &os, const Money &M)
	{

		double dollar = M.cent / 100;
		double cent = M.cent % 100;
		std::string valuta = M.valuta_out;


		return os << valuta << dollar << "." << std::setw(2) << std::setfill('0') << cent << '\n';
	}
	//=====================================================================================================================================
	friend std::istream &operator>>(std::istream &is, Money &M)
	{
		char op = 'NULL';
		double D = 0.0;
		double scalar = 0.0;

		M.valuta = M.char_to_string(is, M);

		is >> D;

		M.cent = D * 100;

		return is;
	}
	//=====================================================================================================================================
	Money Enter();
	double Rounding(double &D);
	char char_to_string(std::istream &is, Money &M);
	double Exchange(char &val, double &D);

	Money Operations(Money &M, Money &Mm, char &op);

private:
	long cent = 0.0;
	char valuta = 'NULL';
	double scalar = 0;
	std::string valuta_out = {};
};
//=====================================================================================================================================
Money Money::Operations(Money &M, Money &Mm, char &op)
{
	Money result = {};
	double D1 = M.cent;
	double MD = M.Exchange(M.valuta, D1);

	if (M.scalar != 0)
	{
		if (op == '*')
		{
			MD *= scalar;
			MD = M.Rounding(MD);
			result.cent = MD;
		}

		if (op == '/')
		{
			MD /= scalar;
			MD = M.Rounding(MD);
			result.cent = MD;
		}
	}
	else
	{
		double D2 = Mm.cent;
		D2 = Mm.Exchange(Mm.valuta, D2);
		D1 = M.Rounding(D1);

		D2 = Mm.Rounding(D2);

		if (op == '+')
		{
			MD = D1 + D2;
			MD = M.Rounding(MD);
			result.cent = MD;
		}

		if (op == '-')
		{
			MD = D1 - D2;
			MD = M.Rounding(MD);
			result.cent = MD;
		}
	}
	return result;
}
//=====================================================================================================================================
char Money::char_to_string(std::istream &is, Money &M)
{
	std::string val = {};
	char current = 'NULL';

	is.get(current);

	if (isalpha(current))
	{
		val += current;


		is.get(current);

		if (isalpha(current))
		{
			val += current;

			is.get(current);

			if (isalpha(current))
			{
				val += current;
			}
		}
	}

	if (val == "USD")
		return 'U';

	if (val == "DKK")
		return 'D';

	if (val == "EUR")
		return 'E';

	if (val == "RUB")
		return 'R';

	if (val == "CNY")
		return 'C';

	if (val == "GBP")
		return 'G';

	if (val == "CHF")
		return 'F';
}
//=====================================================================================================================================
double Money::Exchange(char &valuta, double &D)
{
	double DKK_Ex = 0.158;
	double EUR_Ex = 1.05;
	double RUB_Ex = 0.013;
	double GBP_Ex = 1.7554;
	double CNY_Ex = 0.1449;
	double CHF_Ex = 1.3;

	switch (valuta)
	{
		case 'U': return D;
		case 'D': return D *= DKK_Ex;
		case 'E': return D *= EUR_Ex;
		case 'R': return D *= RUB_Ex;
		case 'G': return D *= GBP_Ex;
		case 'C': return D *= CNY_Ex;
		case 'F': return D *= CHF_Ex;
		default:
			return D;
	}

	return D;
}
//=====================================================================================================================================
double Money::Rounding(double &D)
{
	int D_round = (int)D;

	int D_interval1 = (D - D_round) * 1000;
	int D_interval2 = (D - D_round) * 100;

	int last_dig = D_interval1 % 10;

	if (last_dig >= 5 && last_dig != 0)
	{
		D_interval2++;
		double cents = (D_round * 100) + D_interval2;
		return cents;
	}

	return D;
}
//=====================================================================================================================================
Money Money::Enter()
{
	Money GoCin1, GoCin2, result;
	std::string valuta = {};
	char op = 'NULL';

	while (std::cin >> GoCin1 >> op >> GoCin2)
	{
		std::cout << "In valute? USD, DKK, EUR, RUB, CNY, GBP, CHF == "; std::cin >> valuta;
		result.valuta_out = valuta;
		result = result.Operations(GoCin1, GoCin2, op);

		std::cout << result << "\n";
		std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
	}
	return result;
}
//=====================================================================================================================================
int main()
{
	Money mon;
	mon.Enter();
}
//=====================================================================================================================================
/*
//=====================================================================================================================================
	V	14. Разработайте и реализуйте класс Money для вычислений, связанных с долларами и центами,
точность которых определяется по правилу округления 4 / 5 (0, 5 цента округляется вверх,
все, что меньше 0, 5, округляется вниз).Денежные суммы должны представляться в центах
с помощью переменной типа long, но ввод и вывод должны использовать доллары и центы,
например $123.45.Не беспокойтесь о суммах, выходящих за пределы диапазона типа long.
//=====================================================================================================================================
	15. Уточните класс Money, добавив валюту (как аргумент конструктора). Начальное значение в виде десятичного числа допускается,
поскольку такое число можно представить в виде переменной типа long. Не допускайте некорректных операций. Например,
выражение Money*Money не имеет смысла, а USD1.23+DKK5.00 имеет смысл, только если существует таблица преобразования,
определяющая обменный курс между американскими долларами (USD) и датскими кронами (DKK).
//=====================================================================================================================================
	16. Приведите пример вычислений, в котором класс Rational позволяет получить более точные результаты, чем класс Money.
//=====================================================================================================================================
	17. Приведите пример вычислений, в котором класс Rational позволяет получить более точные результаты, чем тип double.
//=====================================================================================================================================
*/
