#include <string>
#include <iostream>
#include <cctype>
#include <iomanip>
#include <stdexcept>
//=====================================================================================================================================
class Money
{
public:

	Money(long cent, char valuta)
		: cent(cent), valuta(valuta)
	{
	}
	//=====================================================================================================================================
	Money()
	{
	}
	//=====================================================================================================================================
	friend std::ostream &operator<<(std::ostream &os, const Money &result)
	{
		double dollar = result.cent / 100;
		double cent = result.cent % 100;
		
		std::string valuta = switch_char(result.valuta_out_R);

		return os << valuta << " - " << dollar << "." << std::setw(2) << std::setfill('0') << cent << '\n';
	}
	//=====================================================================================================================================
	friend std::istream &operator>>(std::istream &is, Money &M)
	{
		is >> std::ws;		// Пропуск всех символов перед чтением

		char op = 'NULL';
		double D;
		
		M.valuta = M.char_to_string(is, M);

		if (M.valuta == 'L')
			return is;

		else
		{
			is >> D;

			if (D < 0)
				throw std::invalid_argument("Error! D < 0");

			double H = D * 100;
			M.cent = M.Rounding(H);
			return is;
		}
	}
	//=====================================================================================================================================
	Money Enter();
	long Rounding(double &D);
	char char_to_string(std::istream &is, Money &M);
	double Exchange(char &val, double &D);
	Money Operations(Money &M, Money &Mm, char &op, char &VO);
	double string_to_double(Money &M, std::string &val);
	char switch_string(std::string &val);
	static std::string switch_char(const char &val);

private:
	long cent = 0.0;
	char valuta = 'L';
	double scalar = 0;
	char valuta_out_R = {};
};
//=====================================================================================================================================
Money Money::Operations(Money &M, Money &Mm, char &op, char &VO)
{
	Money result = {};
	double D1 = M.cent;
	double convert_D1 = M.Exchange(VO, D1);
	double H_convert_D1 = M.Rounding(convert_D1);
	
	result.valuta_out_R = VO;

	if (Mm.scalar != 0)
	{
		if (op == '*')
		{
			if (Mm.scalar == 0)
				throw std::invalid_argument("Error! Wrong scalar");

			H_convert_D1 *= Mm.scalar;
			result.cent = Rounding(H_convert_D1);
		}

		if (op == '/')
		{
			if (Mm.scalar == 0)
				throw std::invalid_argument("Error! Wrong scalar");

			H_convert_D1 /= Mm.scalar;
			result.cent = Rounding(H_convert_D1);
		}
	}
	else
	{
		double D2 = Mm.cent;
		D2 = Mm.Exchange(VO, D2);
		double H_convert_D2 = Mm.Rounding(D2);

		if (op == '+')
		{
			if (Mm.valuta == 'L')
				throw std::invalid_argument("Error! Wrong currency");


			H_convert_D1 += D2;
			result.cent = Rounding(H_convert_D1);
		}

		if (op == '-')
		{
			if (Mm.valuta == 'L')
				throw std::invalid_argument("Error! Wrong currency");

			H_convert_D1 -= D2;
			result.cent = Rounding(H_convert_D1);
		}
	}
	return result;
}
//=====================================================================================================================================
double Money::string_to_double(Money &M, std::string &val)
{
	M.scalar = std::stod(val);
	return M.scalar;
}
//=====================================================================================================================================
std::string Money::switch_char(const char &val)
{
	if (val == 'U')
		return "USD";

	if (val == 'D')
		return "DKK";

	if (val == 'E')
		return "EUR";

	if (val == 'R')
		return "RUB";

	if (val == 'C')
		return "CNY";

	if (val == 'G')
		return "GBP";

	if (val == 'F')
		return "CHF";
}
//=====================================================================================================================================
char Money::switch_string(std::string &val)
{
	if (val == "USD")
		return 'U';

	if (val == "DKK")
		return 'D';

	if (val == "EUR")
		return 'E';

	if (val == "RUB")
		return 'R';

	if (val == "CNY")
		return 'C';

	if (val == "GBP")
		return 'G';

	if (val == "CHF")
		return 'F';
}
//=====================================================================================================================================
char Money::char_to_string(std::istream &is, Money &M)
{
	std::string val = {};
	char current = 'NULL';
	double scalar;

	is.get(current);

	while (isdigit(current))
	{
		val += current;
		is.get(current);
	}

	if (val != "")
	{
		string_to_double(M, val);
		is.putback(current);
		return 'L';
	}


	while (isalpha(current))
	{
		val += current;
		is.get(current);
	}

	is.putback(current);

	switch_string(val);
}
//=====================================================================================================================================
double Money::Exchange(char &valuta, double &D)
{
	double DKK_Ex = 0.158;
	double EUR_Ex = 1.05;
	double RUB_Ex = 0.036;
	double GBP_Ex = 1.36;
	double CNY_Ex = 0.1449;
	double CHF_Ex = 1.3;

	switch (valuta)
	{
		case 'U': return D;
		case 'D': return D * DKK_Ex;
		case 'E': return D * EUR_Ex;
		case 'R': return D * RUB_Ex;
		case 'G': return D * GBP_Ex;
		case 'C': return D * CNY_Ex;
		case 'F': return D * CHF_Ex;
		default:
			return D;
	}

	return D;
}
//=====================================================================================================================================
long Money::Rounding(double &D)
{
	long cent_R = D;
	int D_round = (int)D;
	double D_interval1 = (D - D_round);

	if (D_interval1 >= 0.5)
	{
		cent_R++;
		return cent_R;
	}
	else
		return cent_R;
}
//=====================================================================================================================================
Money Money::Enter()
{
	Money GoCin1, GoCin2, result;
	std::string valuta = {};
	std::string valuta_out = {};
	char op = 'NULL';

	while (std::cin >> GoCin1 >> op >> GoCin2)
	{
		std::cout << "Please, enter сurrency for converting? USD, CHF, EUR, DKK, RUB, GBP, CNY == "; std::cin >> valuta_out;
		char VO = switch_string(valuta_out);
		result = result.Operations(GoCin1, GoCin2, op, VO);
		std::cout << result << "\n";
	}
	return result;
}
//=====================================================================================================================================
int main() try
{
	Money mon;
	mon.Enter();	//	lab-6R
}
catch (const std::exception &e)
{
	std::cerr << "!!! " << e.what() << '\n';
	return 1;
}
//=====================================================================================================================================
/*
//=====================================================================================================================================
	V	14. Разработайте и реализуйте класс Money для вычислений, связанных с долларами и центами,
точность которых определяется по правилу округления 4 / 5 (0, 5 цента округляется вверх,
все, что меньше 0, 5, округляется вниз).Денежные суммы должны представляться в центах
с помощью переменной типа long, но ввод и вывод должны использовать доллары и центы,
например $123.45.Не беспокойтесь о суммах, выходящих за пределы диапазона типа long.
//=====================================================================================================================================
	V	15. Уточните класс Money, добавив валюту (как аргумент конструктора). Начальное значение в виде десятичного числа допускается,
поскольку такое число можно представить в виде переменной типа long. Не допускайте некорректных операций. Например,
выражение Money*Money не имеет смысла, а USD1.23+DKK5.00 имеет смысл, только если существует таблица преобразования,
определяющая обменный курс между американскими долларами (USD) и датскими кронами (DKK).
//=====================================================================================================================================
	16. Приведите пример вычислений, в котором класс Rational позволяет получить более точные результаты, чем класс Money.
//=====================================================================================================================================
	17. Приведите пример вычислений, в котором класс Rational позволяет получить более точные результаты, чем тип double.
//=====================================================================================================================================
*/
